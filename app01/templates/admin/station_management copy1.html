{% load static %}
<html lang='zh-CN'>

<head>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>工站管理 - 实验任务编辑</title>

    <!-- 外部资源 -->
    <script src='https://cdn.tailwindcss.com'></script>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="{% static 'plugins/bootstrap-5.3.0-alpha1-dist/css/bootstrap.css' %}" />
    <link rel="stylesheet" href="{% static 'css/admin-dashboard.css' %}" />
    <script src="https://unpkg.com/echarts@5.4.3/dist/echarts.min.js"></script>

    <style>
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* 基础样式 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f8f9fa;
            height: 100vh;
            overflow: hidden;
        }

        /* 侧边栏样式 */
        .sidebar {
            background: linear-gradient(180deg, #343a40 0%, #212529 100%);
            color: white;
            height: 100%;
            position: fixed;
            top: 56px;
            left: 0;
            bottom: 0;
            width: 250px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 3px 0 10px rgba(0, 0, 0, 0.2);
        }

        .sidebar h4 {
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            font-weight: 600;
        }

        /* 主内容区域 */
        .main-content {
            margin-left: 250px;
            margin-top: 56px;
            height: calc(100vh - 56px);
            overflow-y: auto;
            padding: 20px;
        }

        /* 导航链接样式 */
        .nav-link {
            transition: all 0.3s ease;
            color: #e9ecef;
            padding: 12px 15px;
            border-left: 3px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 3px solid #0d6efd;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: rgba(13, 110, 253, 0.2);
            color: white;
            border-left: 3px solid #0d6efd;
        }

        .nav-link i {
            transition: transform 0.3s ease;
        }

        .nav-link:hover i {
            transform: scale(1.2);
        }

        /* 卡片和表格样式 */
        .stat-card,
        .experiment-table {
            border-radius: 0.5rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        .modal-content {
            border-radius: 0.5rem;
        }
    </style>
</head>

<body>

    <!-- 顶部导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'admin_experiment_tasks' %}">
                <span style="display: flex; align-items: center;">
                    <img src="{% static 'img/iccas.jpg' %}" alt="Logo" style="height: 30px; width: auto; margin-right: 10px;">
                    <span class="text-white" style="font-size: 30px !important;">智慧精准合成实验室</span>
                </span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle fa-lg me-2"></i>
                            <span>{{ user.username }}</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <a class="dropdown-item d-flex align-items-center"
                                    href="{% url 'admin_experiment_tasks' %}">
                                    <i class="fas fa-user me-2 text-primary"></i>
                                    <span>个人资料</span>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item d-flex align-items-center"
                                    href="{% url 'admin_experiment_tasks' %}">
                                    <i class="fas fa-cog me-2 text-warning"></i>
                                    <span>账号设置</span>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="{% url 'logout' %}">
                                    <i class="fas fa-sign-out-alt me-2 text-danger"></i>
                                    <span>退出登录</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 左侧导航栏 -->
    <div class="sidebar">
        <div class="p-4">
            <nav>
                <ul class="nav flex-column">
                    <li class="nav-item mb-3">
                        <a href="{% url 'admin_experiment_tasks' %}" class="nav-link rounded hover-bg-light">
                            <i class="fas fa-vials fa-lg me-3 text-primary"></i>
                            <span class="text-white">实验任务</span>
                        </a>
                    </li>
                    <li class="nav-item mb-3">
                        <a href="{% url 'admin_user_management' %}" class="nav-link rounded hover-bg-light">
                            <i class="fas fa-users fa-lg me-3 text-success"></i>
                            <span class="text-white">用户管理</span>
                        </a>
                    </li>
                    <li class="nav-item mb-3">
                        <a href="{% url 'sadmin_station_management' %}" class="nav-link rounded hover-bg-light">
                            <i class="fas fa-flask fa-lg me-3 text-info"></i>
                            <span class="text-white">工站管理</span>
                        </a>
                    </li>
                    <li class="nav-item mb-3">
                        <a href="#" class="nav-link rounded hover-bg-light">
                            <i class="fas fa-chart-bar fa-lg me-3 text-warning"></i>
                            <span class="text-white">数据统计</span>
                        </a>
                    </li>
                    <li class="nav-item mb-3">
                        <a href="#" class="nav-link rounded hover-bg-light">
                            <i class="fas fa-cog fa-lg me-3 text-secondary"></i>
                            <span class="text-white">系统设置</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content">
        <div class='min-h-screen flex flex-col'>
            <!-- 顶部导航/工站选项卡 -->
            <header class='bg-white shadow-md py-4 px-6'>
                <nav class='flex space-x-6 overflow-x-auto pb-2'>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='batching' href='javascript:void(0);'>
                        固液配料
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='reaction' href='javascript:void(0);'>
                        反应
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='tlc' href='javascript:void(0);'>
                        点板
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='column' href='javascript:void(0);'>
                        过柱
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='filtration' href='javascript:void(0);'>
                        抽滤分液
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='rotaryEvaporation' href='javascript:void(0);'>
                        旋蒸
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='gcms' href='javascript:void(0);'>
                        GCMS
                    </a>
                    <a class='tab-item text-gray-600 hover:text-blue-600 px-4 py-2 rounded-md text-lg font-medium whitespace-nowrap transition-colors duration-200'
                        data-tab='hplc' href='javascript:void(0);'>
                        HPLC
                    </a>
                </nav>
            </header>
            <!-- 主内容区域 -->
            <main class='flex-1 p-6 overflow-y-auto'>
                <!-- 各工站内容区域，默认显示第一个 -->
                <div class='tab-content bg-white p-8 rounded-lg shadow-md' id='batching-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        配料工站
                    </h2>
                    <div class='space-y-6'>
                        <!-- 试剂添加栏 -->
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                试剂添加
                            </h3>
                            <div class='space-y-4' id='batching-reagents-container'>
                                <!-- 初始试剂输入行 -->
                                <div class='flex items-center space-x-4 reagent-row'>
                                    <input
                                        class='shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent flex-1 reagent-name-input'
                                        list='reagent-suggestions' placeholder='试剂名称' type='text' />
                                    <datalist id='reagent-suggestions'>

                                    </datalist>
                                    <input
                                        class='shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-24'
                                        placeholder='用量' type='number' />
                                    <select
                                        class='shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-24'>
                                        <option value='g'>
                                            克 (g)
                                        </option>
                                        <option value='ml'>
                                            毫升 (ml)
                                        </option>
                                        <option value='mol'>
                                            摩尔 (mol)
                                        </option>
                                    </select>
                                    <button
                                        class='remove-reagent-btn text-red-500 hover:text-red-700 focus:outline-none'
                                        type='button'>
                                        <i class='fas fa-minus-circle text-xl'>

                                        </i>
                                    </button>
                                </div>
                            </div>
                            <button
                                class='mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200'
                                id='add-batching-reagent-btn' type='button'>
                                <i class='fas fa-plus mr-2'>

                                </i>
                                添加试剂
                            </button>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='reaction-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        反应工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                反应条件
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2'
                                        for='reaction-temperature'>
                                        温度 (°C):
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='reaction-temperature' placeholder='例如: 25' type='number' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2'
                                        data-yteditvalue='反应时长 (分钟):' for='reaction-time'>
                                        反应时长 (分钟):
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='reaction-time' placeholder='例如: 4' type='number' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2'
                                        for='reaction-stirring-speed'>
                                        搅拌速度 (rpm/min):
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='reaction-stirring-speed' placeholder='例如: 300' type='number' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='tlc-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        点板工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='tlc-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='tlc-steps' placeholder='请详细描述点板的实验步骤，包括展开剂、显色方法等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                点板结果记录
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='tlc-solvent'>
                                        展开剂:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='tlc-solvent' placeholder='例如: 乙酸乙酯:石油醚 = 1:3' type='text' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='tlc-rf'>
                                        Rf 值:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='tlc-rf' placeholder='例如: 0.5, 0.8' type='text' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='column-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        过柱工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='column-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='column-steps' placeholder='请详细描述过柱的实验步骤，包括填料、洗脱剂梯度等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                过柱参数
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='column-packing'>
                                        填料:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='column-packing' placeholder='例如: 硅胶 (200-300目)' type='text' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='column-eluent'>
                                        洗脱剂:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='column-eluent' placeholder='例如: 乙酸乙酯/石油醚' type='text' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='filtration-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        抽滤分液工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='filtration-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='filtration-steps' placeholder='请详细描述抽滤分液的实验步骤，包括溶剂选择、操作要点等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                分液参数
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='filtration-solvent1'>
                                        有机相溶剂:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='filtration-solvent1' placeholder='例如: 乙酸乙酯' type='text' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='filtration-solvent2'>
                                        水相溶剂:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='filtration-solvent2' placeholder='例如: 水' type='text' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='rotaryEvaporation-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        旋蒸工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='rotaryEvaporation-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='rotaryEvaporation-steps' placeholder='请详细描述旋蒸的实验步骤，包括温度、真空度等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                旋蒸参数
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2'
                                        for='rotaryEvaporation-temperature'>
                                        水浴温度 (°C):
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='rotaryEvaporation-temperature' placeholder='例如: 40' type='number' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2'
                                        for='rotaryEvaporation-vacuum'>
                                        真空度 (mbar):
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='rotaryEvaporation-vacuum' placeholder='例如: 50' type='number' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='gcms-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        GCMS工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='gcms-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='gcms-steps' placeholder='请详细描述GCMS的实验步骤，包括样品制备、进样参数、程序升温等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                GCMS参数
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='gcms-column'>
                                        色谱柱:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='gcms-column' placeholder='例如: HP-5MS' type='text' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='gcms-program'>
                                        升温程序:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='gcms-program' placeholder='例如: 50°C (2min) -> 10°C/min -> 280°C (5min)'
                                        type='text' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='tab-content bg-white p-8 rounded-lg shadow-md hidden' id='hplc-content'>
                    <h2 class='text-2xl font-semibold text-gray-800 mb-6'>
                        HPLC工站
                    </h2>
                    <div class='space-y-6'>
                        <div>
                            <label class='block text-gray-700 text-sm font-bold mb-2' for='hplc-steps'>
                                实验步骤:
                            </label>
                            <textarea
                                class='shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y'
                                id='hplc-steps' placeholder='请详细描述HPLC的实验步骤，包括样品制备、流动相、检测器等...' rows='8'>

        </textarea>
                        </div>
                        <div>
                            <h3 class='text-xl font-semibold text-gray-800 mb-4'>
                                HPLC参数
                            </h3>
                            <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='hplc-column'>
                                        色谱柱:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='hplc-column' placeholder='例如: C18' type='text' />
                                </div>
                                <div>
                                    <label class='block text-gray-700 text-sm font-bold mb-2' for='hplc-mobile-phase'>
                                        流动相:
                                    </label>
                                    <input
                                        class='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                        id='hplc-mobile-phase' placeholder='例如: 甲醇/水' type='text' />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer class='bg-white shadow-md py-4 px-6 mt-6 flex justify-center'>
                <a class='yt-a-defalut-link bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 flex'
                    target='_top' is-page='true' href='javascript:void(0);'
                    custom-href='w=768&h=531&appuuid=1942865613596655616&version=21&pageType=web&uuid=1942865613621821440&appName=自动化实验室'
                    onclick='
              const parseWithURLSearchParams = (queryString) => {
                const params = queryString.split("&")
                const result = {}
                params.forEach(param => {
                  const key = param.split("=")[0]
                  const value = param.split("=")[1]
                  result[key] = value
                })
                return result
              }
              const topWin = window.top
              const originParams = parseWithURLSearchParams(topWin.document.location.href.split("?")[1])
              const href = this.getAttribute("custom-href")
              if (href) {
                if (topWin.location.hash.startsWith("#/edit?")) {
                  const { uuid } = parseWithURLSearchParams(href)
                  const event = new CustomEvent("changePage", {
                    detail: { uuid },
                    bubbles: true,
                    cancelable: true
                  });
                  topWin.dispatchEvent(event)
                } else {
                  const newParams = parseWithURLSearchParams(href)
                  const params = Object.keys(originParams).reduce((acc, key) => {
                    if (acc !== "?") {
                      acc+="&"
                    }
                    acc+=key+"="+newParams[key]
                    return acc
                  }, "?")
                  topWin.location.href = topWin.document.location.href.split("?")[0] + params
                }
              }
            ' custom-a='true' is-add='true' style='padding: 0px; border: 0px; box-shadow: none;'>
                    <button
                        class='bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200'
                        id='submit-task-btn' type='button' data-selectorname='#submit-task-btn' style>
                        完成实验设定，提交任务
                    </button>
                </a>
            </footer>
        </div>
    </div>


    <script>// 定义要劫持的属性
        var ytCustomProperties = ['textContent', 'innerText'];
        ytCustomProperties.forEach(function (prop) {
            var descriptor = Object.getOwnPropertyDescriptor(Element.prototype, prop) || Object.getOwnPropertyDescriptor(Node.prototype, prop);
            if (descriptor && descriptor.set) {
                var originalSet = descriptor.set;
                Object.defineProperty(Element.prototype, prop, {
                    set: function set(value) {
                        // 优先取 data-yteditvalue，否则用传入的 value
                        var finalValue = this.dataset.yteditvalue ?? value;
                        originalSet.call(this, finalValue);
                    },
                    configurable: true
                });
            }
        });
        // 保存原生方法
        var nativeElementQuerySelector = Element.prototype.querySelector;
        var nativeDocumentQuerySelector = Document.prototype.querySelector;
        function ytCustomQuerySelector(selector) {
            // 第二步：尝试用选择器获取DOM元素
            // 执行原生选择器查询
            var foundElement = this === document ? nativeDocumentQuerySelector.call(this, selector) : nativeElementQuerySelector.call(this, selector);
            if (foundElement) {
                // 设置属性
                if (!foundElement.hasAttribute('data-selectorname')) {
                    foundElement.setAttribute('data-selectorname', selector);
                }
                // 第三步：直接返回找到的元素
                return foundElement;
            }

            // 如果通过选择器没找到，尝试通过data-selectorName属性查找
            var allElements = document.querySelectorAll('[data-selectorname]');
            for (var i = 0; i < allElements.length; i++) {
                if (allElements[i].getAttribute('data-selectorname') === selector) {
                    return allElements[i];
                }
            }

            // 如果都没找到，返回null
            return null;
        }

        // 如果需要也重写querySelectorAll，可以类似实现
        // 重写原生的querySelector
        Document.prototype.querySelector = ytCustomQuerySelector;
        Element.prototype.querySelector = ytCustomQuerySelector;
        var nativeElementInsertBefore = Element.prototype.insertBefore;
        function ytCustomInsertBefore(newNode, referenceNode) {
            // 当前元素作为默认父元素
            var defaultParentNode = this;

            // 检查参考节点是否存在
            if (!referenceNode) {
                // 如果没有提供参考节点，直接添加到末尾
                return nativeElementInsertBefore.call(defaultParentNode, newNode, null);
            }

            // 检查参考节点是否仍然是父节点的直接子节点
            if (referenceNode.parentNode === defaultParentNode) {
                // 正常情况：参考节点仍在父节点下，直接插入
                return nativeElementInsertBefore.call(defaultParentNode, newNode, referenceNode);
            }

            // 检查参考节点是否有 data-ytparentvalue 属性（被移动出去的节点）
            var referenceParentValue = referenceNode.getAttribute('data-ytparentvalue');
            if (referenceParentValue) {
                // 查找具有匹配 data-ytextravalue 的父元素
                var actualParentNode = document.querySelector('[data-ytextravalue="' + referenceParentValue + '"]');
                if (actualParentNode) {
                    // 获取参考节点原来的索引位置
                    var originalIndex = referenceNode.getAttribute('data-ytoriginindex');
                    if (originalIndex !== null && !isNaN(originalIndex)) {
                        // 获取实际父节点当前的所有子节点
                        var children = Array.from(actualParentNode.children);

                        // 查找应该插入的位置
                        for (var i = 0; i < children.length; i++) {
                            var child = children[i];
                            var childOriginalIndex = child.getAttribute('data-ytoriginindex');

                            // 如果子节点有原始索引，并且比参考节点的原始索引大
                            if (childOriginalIndex !== null && !isNaN(childOriginalIndex)) {
                                if (parseInt(childOriginalIndex) > parseInt(originalIndex)) {
                                    // 找到第一个索引更大的节点，插入到它前面
                                    return nativeElementInsertBefore.call(actualParentNode, newNode, child);
                                }
                            }
                        }

                        // 如果没有找到更大的索引，插入到最后
                        return nativeElementInsertBefore.call(actualParentNode, newNode, null);
                    }

                    // 没有原始索引信息，插入到实际父元素的最后
                    return nativeElementInsertBefore.call(actualParentNode, newNode, null);
                }
            }

            // 默认情况：插入到当前父元素的最后
            return nativeElementInsertBefore.call(defaultParentNode, newNode, null);
        }

        // 重写原生 insertBefore 方法
        Element.prototype.insertBefore = ytCustomInsertBefore;

        // 需要给新添加的a标签跳转链接加入一些必要的样式 保证加入后不影响原来的布局
        function addUniqueStyle(cssText) {
            var id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'custom-style';
            var targetDom = document.getElementById(id);
            if (targetDom && targetDom.tagName === 'STYLE') return; // 已存在则跳过

            var style = document.createElement('style');
            style.id = id;
            style.innerHTML = cssText;
            document.head.appendChild(style);
        }
        addUniqueStyle('.yt-a-defalut-link[custom-a="true"] > * { margin:0;flex:1; }');
        document.addEventListener('DOMContentLoaded', function () {
            var tabItems = document.querySelectorAll('.tab-item');
            var tabContents = document.querySelectorAll('.tab-content');
            var addBatchingReagentBtn = document.getElementById('add-batching-reagent-btn');
            var batchingReagentsContainer = document.getElementById('batching-reagents-container');
            // 初始化：设置第一个tab为激活状态
            if (tabItems.length > 0) {
                tabItems[0].classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
            }
            // 切换工站选项卡
            tabItems.forEach(function (item) {
                item.addEventListener('click', function () {
                    // 移除所有tab的激活样式
                    tabItems.forEach(function (t) {
                        return t.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                    });
                    // 隐藏所有内容区域
                    tabContents.forEach(function (content) {
                        return content.classList.add('hidden');
                    });
                    // 添加当前tab的激活样式
                    this.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                    // 显示对应的内容区域
                    var targetTab = this.getAttribute('data-tab');
                    document.getElementById("".concat(targetTab, "-content")).classList.remove('hidden');
                });
            });
            // 添加试剂行
            addBatchingReagentBtn.addEventListener('click', function () {
                var newReagentRow = document.createElement('div');
                newReagentRow.classList.add('flex', 'items-center', 'space-x-4', 'reagent-row');
                newReagentRow.innerHTML = "\n<input type=\"text\" placeholder=\"\u8BD5\u5242\u540D\u79F0\" class=\"shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent flex-1 reagent-name-input\" list=\"reagent-suggestions\">\n                    <input type=\"number\" placeholder=\"\u7528\u91CF\" class=\"shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-24\">\n                    <select class=\"shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-24\">\n                        <option value=\"g\">\u514B (g)</option>\n                        <option value=\"ml\">\u6BEB\u5347 (ml)</option>\n                        <option value=\"mol\">\u6469\u5C14 (mol)</option>\n                    </select>\n                    <button type=\"button\" class=\"remove-reagent-btn text-red-500 hover:text-red-700 focus:outline-none\">\n                        <i class=\"fas fa-minus-circle text-xl\"></i>\n                    </button>\n";
                batchingReagentsContainer.appendChild(newReagentRow);
                populateReagentSuggestions(); // 新增行后重新填充建议
            });

            // 填充试剂建议列表
            var populateReagentSuggestions = function populateReagentSuggestions() {
                var reagentSuggestions = document.getElementById('reagent-suggestions');
                reagentSuggestions.innerHTML = ''; // 清空现有选项
                var materialLibrary = ["硫酸", "盐酸", "氢氧化钠", "乙醇", "甲醇", "丙酮", "乙酸乙酯", "石油醚", "氯仿", "二氯甲烷", "四氢呋喃", "乙醚", "苯", "甲苯", "二甲苯", "水", "碳酸钠", "碳酸氢钠", "氯化钠", "硫酸镁", "无水硫酸钠", "硅胶", "氧化铝"];
                materialLibrary.forEach(function (reagent) {
                    var option = document.createElement('option');
                    option.value = reagent;
                    reagentSuggestions.appendChild(option);
                });
            };

            // 页面加载时和添加新行时填充建议
            populateReagentSuggestions();

            // 移除试剂行 (事件委托)
            batchingReagentsContainer.addEventListener('click', function (event) {
                if (event.target.closest('.remove-reagent-btn')) {
                    var rowToRemove = event.target.closest('.reagent-row');
                    if (rowToRemove) {
                        rowToRemove.remove();
                    }
                }
            });
        });</script>
</body>

</html>