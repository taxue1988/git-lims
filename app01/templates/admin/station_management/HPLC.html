{% extends 'admin/station_management.html' %}

{% block title %}HPLC - 工站管理{% endblock %}

{% block main_content %}
{{ block.super }}

<!-- 工站状态卡片 -->
<div class="card mb-4" id="hplcStatusCard">
    <div class="card-header bg-info text-white d-flex justify-content-between align-items-center"
         data-bs-toggle="collapse" data-bs-target="#hplcStationStatus"
         aria-expanded="true" aria-controls="hplcStationStatus" style="cursor: pointer;">
        <h4 class="mb-0"><i class="fas fa-chart-area"></i> 工站状态</h4>
        <div class="d-flex align-items-center">
            <span class="badge bg-light text-dark me-2">实时监控</span>
            <i class="fas fa-chevron-down collapse-icon"></i>
        </div>
    </div>
    <div class="collapse show" id="hplcStationStatus">
        <div class="card-body">
            <div class="row">
                <div class="col-md-4">
                    <div class="d-flex align-items-center mb-3">
                        <i id="armStatusIcon" class="fas fa-hand-rock text-secondary me-3 fa-lg"></i>
                        <div>
                            <h6 class="mb-1 text-muted">机械臂</h6>
                            <p id="armStatus" class="mb-0 fw-bold text-secondary">连接中...</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-center mb-3">
                        <i id="hplcStatusIcon" class="fas fa-vials text-secondary me-3 fa-lg"></i>
                        <div>
                            <h6 class="mb-1 text-muted">HPLC</h6>
                            <p id="hplcStatus" class="mb-0 fw-bold text-secondary">连接中...</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-clock text-secondary me-3 fa-lg"></i>
                        <div>
                            <h6 class="mb-1 text-muted">运行时间</h6>
                            <p class="mb-0 fw-bold"><span id="runtimeHours">0</span> 小时 <span id="runtimeMinutes">00</span> 分</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-2">
                <div class="col-md-3">
                    <div class="alert alert-light py-2 mb-0 d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-tasks text-info me-2"></i>
                            <span class="text-muted">待分析任务数</span>
                        </div>
                        <span class="badge bg-info" id="pendingAnalysis">0</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="alert alert-light py-2 mb-0 d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <span class="text-muted">已完成分析</span>
                        </div>
                        <span class="badge bg-success" id="completedAnalysis">0</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="alert alert-light py-2 mb-0 d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center">
                            <i id="connectionStatusIcon" class="fas fa-wifi text-danger me-2"></i>
                            <span class="text-muted">连接状态</span>
                        </div>
                        <span class="badge bg-danger" id="connectionStatus">离线</span>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-12">
                    <div class="d-flex flex-wrap gap-2">
                        <button id="refreshStatusBtn" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-sync-alt me-1"></i>刷新状态
                        </button>

                        <button id="getInstrumentInfoBtn" class="btn btn-outline-secondary btn-sm">
                            <i class="fas fa-info-circle me-1"></i>仪器信息
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 实时日志卡片（移动到工站状态下方） -->
<div class="card mt-4">
    <div class="card-header bg-success text-white d-flex justify-content-between align-items-center"
         data-bs-toggle="collapse" data-bs-target="#hplcLogs"
         aria-expanded="true" aria-controls="hplcLogs" style="cursor: pointer;">
        <h4 class="mb-0"><i class="fas fa-terminal"></i> 实时日志</h4>
        <div class="d-flex align-items-center">
            <button id="clearLogsBtn" class="btn btn-outline-light btn-sm me-2" onclick="event.stopPropagation();">
                <i class="fas fa-trash"></i> 清空
            </button>
            <i class="fas fa-chevron-down collapse-icon"></i>
        </div>
    </div>
    <div class="collapse show" id="hplcLogs">
        <div class="card-body p-0">
            <div id="logContainer" class="log-container" style="height: 300px; overflow-y: auto; background-color: #1e1e1e; color: #ffffff; font-family: 'Courier New', monospace; font-size: 12px; padding: 10px;">
                <div class="log-entry text-info">
                    <span class="timestamp">[系统]</span> 等待连接到 HPLC Worker...
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 当前仓位卡片 -->
<div class="card mt-4">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center"
         data-bs-toggle="collapse" data-bs-target="#hplcPositions"
         aria-expanded="true" aria-controls="hplcPositions" style="cursor: pointer;">
        <h4 class="mb-0"><i class="fas fa-boxes"></i> 当前仓位（1）</h4>
        <i class="fas fa-chevron-down collapse-icon"></i>
    </div>
    <div class="collapse show" id="hplcPositions">
        <div class="card-body">
            <div class="row">
                <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                    <div class="card h-100 position-card border-light">
                        <div class="card-body text-center">
                            <h5 class="card-title text-primary">仓位 1</h5>
                            <p class="card-text text-muted small">HPLC 工站</p>
                            <div class="position-status">
                                <div class="alert alert-light py-2 mb-0">
                                    <i class="fas fa-circle"></i>
                                    <span class="text-muted">位置空闲</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- HPLC 分析任务列表卡片 -->
<div class="card mt-4">
    <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center"
         data-bs-toggle="collapse" data-bs-target="#hplcTasks"
         aria-expanded="true" aria-controls="hplcTasks" style="cursor: pointer;">
        <h4 class="mb-0"><i class="fas fa-tasks"></i> HPLC 分析任务列表</h4>
        <div class="d-flex align-items-center">
            <button class="btn btn-sm btn-dark" data-bs-toggle="modal" data-bs-target="#createTaskModal">
                <i class="fas fa-plus-circle me-1"></i> 创建分析任务
            </button>
            <i class="fas fa-chevron-down collapse-icon ms-3"></i>
        </div>
    </div>
    <div class="collapse show" id="hplcTasks">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover" id="tasksTable">
                    <thead class="table-light">
                        <tr>
                            <th>任务ID</th>
                            <th>实验名称</th>
                            <th>样品瓶号</th>
                            <th>创建时间</th>
                            <th>状态</th>
                            <th>任务用时</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="no-tasks-row">
                            <td colspan="7" class="text-center text-muted py-4">
                                <i class="fas fa-inbox fa-2x mb-2"></i><br>
                                暂无任务，请点击右上角创建
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- 创建任务 Modal -->
<div class="modal fade" id="createTaskModal" tabindex="-1" aria-labelledby="createTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createTaskModalLabel">创建新的分析任务</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="createTaskForm">
                    <div class="mb-3">
                        <label for="experimentName" class="form-label">实验名称</label>
                        <input type="text" class="form-control" id="experimentName" placeholder="例如：样品批次H-01" required>
                    </div>
                    <div class="mb-3">
                        <label for="bottleNum" class="form-label">样品瓶号 (0-33)</label>
                        <input type="number" class="form-control" id="bottleNum" min="0" max="33" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="saveTaskBtn">创建任务</button>
            </div>
        </div>
    </div>
</div>

 

<!-- 查看结果 Modal -->
<div class="modal fade" id="resultModal" tabindex="-1" aria-labelledby="resultModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header position-relative">
                <h5 class="modal-title" id="resultModalLabel">分析结果</h5>
                <div class="position-absolute start-50 translate-middle-x d-flex gap-2 align-items-center">
                    <button type="button" class="btn btn-primary btn-sm" id="downloadPngBtn">
                        <i class="fas fa-download"></i> 导出 PNG
                    </button>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="resultLoading" class="text-muted">正在加载数据，请稍候...</div>
                <canvas id="resultChart" style="width:100%; height:420px; display:none;"></canvas>
                <div id="resultMessage" class="alert alert-warning mt-2" style="display:none;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // 面包屑高亮“HPLC”
    var breadcrumb = document.querySelector('nav[aria-label="breadcrumb"] .breadcrumb');
    if (breadcrumb) {
        var links = breadcrumb.querySelectorAll('.breadcrumb-item a');
        var indicator = breadcrumb.querySelector('.breadcrumb-indicator');
        var target = null;
        for (var i = 0; i < links.length; i++) {
            if (links[i].textContent.trim() === 'HPLC') { target = links[i]; break; }
        }
        if (target) {
            links.forEach(function(a){ a.classList.remove('active'); });
            target.classList.add('active');
            if (indicator) {
                indicator.style.width = target.offsetWidth + 'px';
                indicator.style.transform = 'translateX(' + target.offsetLeft + 'px)';
            }
        }
    }

    // 卡片折叠图标旋转
    var collapseElements = document.querySelectorAll('[data-bs-toggle="collapse"]');
    collapseElements.forEach(function(element) {
        element.addEventListener('click', function() {
            var icon = this.querySelector('.collapse-icon');
            var target = document.querySelector(this.getAttribute('data-bs-target'));
            setTimeout(function() {
                if (target && target.classList.contains('show')) {
                    icon.style.transform = 'rotate(0deg)';
                } else if (icon) {
                    icon.style.transform = 'rotate(180deg)';
                }
            }, 50);
        });
    });

    // --- 全局变量定义 ---
    let totalRuntimeInterval = null;
    let tasks = [];
    let taskIdCounter = 0;
    let isWorkerBusy = false;

    // --- DOM 元素 ---
    const logContainer = document.getElementById('logContainer');
    const connectionStatus = document.getElementById('connectionStatus');
    const connectionStatusIcon = document.getElementById('connectionStatusIcon');
    const armStatus = document.getElementById('armStatus');
    const hplcStatus = document.getElementById('hplcStatus');
    const saveTaskBtn = document.getElementById('saveTaskBtn');
    const createTaskForm = document.getElementById('createTaskForm');
    const tasksTableBody = document.querySelector('#tasksTable tbody');
    const noTasksRow = document.getElementById('no-tasks-row');
    const createTaskModalEl = document.getElementById('createTaskModal');
    const createTaskModal = new bootstrap.Modal(createTaskModalEl);

    function addLog(message, type = 'info') {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry text-${type}`;
        logEntry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
        logContainer.appendChild(logEntry);
        logContainer.scrollTop = logContainer.scrollHeight;
    }

    const wsProto = window.location.protocol === 'https:' ? 'wss://' : 'ws://';
    const socket = new WebSocket(wsProto + window.location.host + '/ws/hplc/');

    socket.onopen = function(e) {
        addLog('成功连接到 HPLC WebSocket 服务器', 'success');
        connectionStatus.textContent = '在线';
        connectionStatus.className = 'badge bg-success';
        connectionStatusIcon.className = 'fas fa-wifi text-success me-2';
        sendMessage('get_status');
        sendMessage('get_arm_status');
    };
    socket.onclose = function(e){
        addLog('WebSocket 连接已断开', 'danger');
        connectionStatus.textContent = '离线';
        connectionStatus.className = 'badge bg-danger';
        connectionStatusIcon.className = 'fas fa-wifi text-danger me-2';
    };
    socket.onerror = function(e){ addLog('WebSocket 连接发生错误', 'danger'); };

    function sendMessage(command){
        if (socket.readyState === WebSocket.OPEN) {
            socket.send(JSON.stringify({'message': command}));
            addLog(`发送指令: ${command}`, 'info');
        } else {
            addLog('WebSocket 未连接，无法发送指令', 'warning');
        }
    }

    document.getElementById('refreshStatusBtn').addEventListener('click', () => sendMessage('get_status'));
    document.getElementById('getInstrumentInfoBtn').addEventListener('click', () => sendMessage('get_instrument_info'));
    document.getElementById('clearLogsBtn').addEventListener('click', () => { logContainer.innerHTML = ''; addLog('日志已清空', 'info'); });

    function saveTasks(){ localStorage.setItem('hplcTasks', JSON.stringify(tasks)); }
    function loadTasks(){ const s = localStorage.getItem('hplcTasks'); if (s){ tasks = JSON.parse(s); taskIdCounter = tasks.length>0? Math.max(...tasks.map(t=>t.displayId)):0; renderTasks(); } }

    function renderTasks(){
        tasksTableBody.innerHTML = '';
        let pending=0, completed=0;
        if (tasks.length===0){
            tasksTableBody.innerHTML = `<tr id="no-tasks-row"><td colspan="7" class="text-center text-muted py-4"><i class=\"fas fa-inbox fa-2x mb-2\"></i><br>暂无任务，请点击右上角创建</td></tr>`;
        } else {
            tasks.forEach(task=>{
                if (task.statusText==='已完成') completed++; else pending++;
                const tr = document.createElement('tr'); tr.id = task.id;
                tr.innerHTML = `
                    <td>${task.displayId}</td>
                    <td>${task.name}</td>
                    <td>${task.bottleNum}</td>
                    <td>${task.time}</td>
                    <td><span class=\"badge ${task.statusClass}\">${task.statusText}</span></td>
                    <td>${task.duration || 'N/A'}</td>
                    <td>
                        <button class=\"btn btn-success btn-sm\" onclick=\"handleRunTask('${task.id}')\" ${task.runButtonDisabled ? 'disabled' : ''}>${task.runButtonHTML}</button>
                        <button id=\"viewResultBtn-${task.id}\" class=\"btn btn-info btn-sm ms-1\" onclick=\"handleViewResult('${task.id}')\" ${task.statusText === '已完成' ? '' : 'disabled'}>
                            <i class=\"fas fa-chart-line\"></i> 查看结果
                        </button>
                        <button class=\"btn btn-danger btn-sm\" onclick=\"handleDeleteTask('${task.id}')\"><i class=\"fas fa-trash\"></i> 删除</button>
                    </td>`;
                tasksTableBody.appendChild(tr);
            });
        }
        document.getElementById('pendingAnalysis').textContent = pending;
        document.getElementById('completedAnalysis').textContent = completed;
    }

    function initializeWorkerStatus(){
        const isAnyTaskRunning = tasks.some(t => !['待运行','排队中','已完成','失败'].includes(t.statusText));
        isWorkerBusy = !!isAnyTaskRunning;
    }

    loadTasks();
    initializeWorkerStatus();

    saveTaskBtn.addEventListener('click', () => {
        const experimentName = document.getElementById('experimentName').value.trim();
        const bottleNumInput = document.getElementById('bottleNum');
        const bottleNum = bottleNumInput.value;
        if (!experimentName || bottleNum === ''){ alert('请填写所有字段'); return; }
        if (parseInt(bottleNum) < 0 || parseInt(bottleNum) > 33){ alert('样品瓶号必须在 0 到 33 之间'); return; }
        taskIdCounter++;
        const taskId = `task-${taskIdCounter}`;
        const currentTime = new Date().toLocaleTimeString();
        const newTask = {
            id: taskId,
            displayId: taskIdCounter,
            name: experimentName,
            bottleNum: bottleNum,
            time: currentTime,
            statusText: '待运行',
            statusClass: 'bg-secondary',
            runButtonHTML: '<i class="fas fa-play"></i> 运行',
            runButtonDisabled: false,
            startTime: null,
            endTime: null,
            duration: ''
        };
        tasks.push(newTask); saveTasks(); renderTasks(); createTaskForm.reset(); createTaskModal.hide();
    });

    window.handleRunTask = function(taskId){
        const task = tasks.find(t=>t.id===taskId); if (!task) return;
        task.statusText = '排队中'; task.statusClass = 'bg-primary'; task.runButtonHTML = '<i class="fas fa-clock"></i> 排队中'; task.runButtonDisabled = true;
        saveTasks(); renderTasks();
        // 直接请求运行，不做复杂排队策略
        sendMessage(`start_analysis_${task.bottleNum}`);
    }

    // 结果查看
    const resultModalEl = document.getElementById('resultModal');
    const resultModal = new bootstrap.Modal(resultModalEl);
    const resultChartCanvas = document.getElementById('resultChart');
    const resultLoading = document.getElementById('resultLoading');
    const resultMessage = document.getElementById('resultMessage');
    let resultChartInstance = null;
    const downloadPngBtn = document.getElementById('downloadPngBtn');

    function showResultLoading(text){ resultLoading.style.display=''; resultLoading.textContent=text||'正在加载数据，请稍候...'; resultChartCanvas.style.display='none'; resultMessage.style.display='none'; }
    function showResultMessage(text, level='warning'){ resultLoading.style.display='none'; resultChartCanvas.style.display='none'; resultMessage.style.display=''; resultMessage.className = `alert alert-${level} mt-2`; resultMessage.textContent = text || '无可显示的数据'; }
    function renderResultChart(xArr, yArr, titleText){
        resultLoading.style.display='none'; resultMessage.style.display='none'; resultChartCanvas.style.display='';
        const ctx = resultChartCanvas.getContext('2d'); if (resultChartInstance) resultChartInstance.destroy();
        resultChartInstance = new Chart(ctx, {
            type: 'line',
            data: { labels: xArr, datasets: [{ label: 'HPLC色谱', data: yArr, borderColor: 'rgba(25, 135, 84, 1)', backgroundColor: 'rgba(25, 135, 84, 0.1)', borderWidth: 1, pointRadius: 0 }] },
            options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, plugins: { legend: { display: false }, title: { display: !!titleText, text: titleText || '' } }, scales: { x: { title: { display: true, text: '时间' }, ticks: { autoSkip: true, maxTicksLimit: 12 } }, y: { title: { display: true, text: '强度' }, beginAtZero: false } } }
        });
    }
    if (downloadPngBtn){ downloadPngBtn.addEventListener('click', function(){ if(!resultChartInstance) return; const link=document.createElement('a'); link.href=resultChartInstance.toBase64Image(); link.download=`hplc_result_${Date.now()}.png`; link.click(); }); }

    window.handleViewResult = function(taskId){ resultModal.show(); showResultLoading('正在请求结果数据...'); sendMessage('get_result_0'); } // 瓶号对结果读取不敏感，读取最新

    window.handleDeleteTask = function(taskId){
        if (!confirm('您确定要删除这个任务吗？')) return;
        const wasRunning = tasks.some(t => t.id===taskId && !['待运行','排队中','已完成','失败'].includes(t.statusText));
        tasks = tasks.filter(t=>t.id!==taskId); saveTasks(); renderTasks(); addLog('任务已删除', 'info');
        if (wasRunning){ isWorkerBusy = false; }
    }

    // WebSocket 入站消息
    socket.onmessage = function(e){
        const data = JSON.parse(e.data); const message = data.message; const sender = data.sender;
        addLog(`收到消息: ${JSON.stringify(message)}`, 'primary');
        if (sender !== 'worker') return;
        switch(message.type){
            case 'worker_connected':
                hplcStatus.textContent = message.status || '就绪'; break;
            case 'status_update':
                hplcStatus.textContent = message.status || '未知'; break;
            case 'arm_status':
                armStatus.textContent = message.status || '未知'; break;
            case 'instrument_info':
                addLog('仪器信息: ' + JSON.stringify(message.info || message.error || {}), 'info'); break;
            case 'analysis_started':
                isWorkerBusy = true; updateRuntimeStart();
                updateAnyRunningTask('任务开始', 'bg-info'); break;
            case 'analysis_complete':
                isWorkerBusy = false; updateAnyRunningTask('已完成', 'bg-success', true); updateRuntimeStopIfIdle(); break;
            case 'analysis_error':
                isWorkerBusy = false; updateAnyRunningTask('失败', 'bg-danger', true); updateRuntimeStopIfIdle(); break;
            case 'analysis_result':
                if (!message.available){ showResultMessage(message.message || '未找到结果文件'); }
                else if (message.series && Array.isArray(message.series.x) && Array.isArray(message.series.y)){
                    renderResultChart(message.series.x, message.series.y, 'HPLC 结果');
                } else { showResultMessage('结果数据格式不正确'); }
                break;
        }
    };

    function updateAnyRunningTask(statusText, statusClass, stopTiming){
        const running = tasks.find(t => t.statusText==='排队中' || t.statusText==='任务开始');
        if (!running) return;
        if (statusText==='任务开始'){ running.startTime = Date.now(); }
        if (stopTiming){ running.endTime = Date.now(); if (running.startTime){ const dur = Math.round((running.endTime - running.startTime)/1000); const m=Math.floor(dur/60); const s=dur%60; running.duration=`${m}分${s}秒`; } }
        running.statusText = statusText; running.statusClass = statusClass; running.runButtonHTML = '<i class="fas fa-redo"></i> 重新运行'; running.runButtonDisabled = false;
        saveTasks(); renderTasks();
    }

    function updateRuntimeStart(){
        if (totalRuntimeInterval) return; if (!localStorage.getItem('hplcTotalRuntimeStart')) localStorage.setItem('hplcTotalRuntimeStart', Date.now());
        updateTotalRuntimeDisplay(); totalRuntimeInterval = setInterval(updateTotalRuntimeDisplay, 10000);
    }
    function updateRuntimeStopIfIdle(){
        clearInterval(totalRuntimeInterval); totalRuntimeInterval = null; localStorage.removeItem('hplcTotalRuntimeStart'); updateTotalRuntimeDisplay();
    }
    function updateTotalRuntimeDisplay(){
        const startTime = localStorage.getItem('hplcTotalRuntimeStart');
        if (!startTime){ document.getElementById('runtimeHours').textContent='0'; document.getElementById('runtimeMinutes').textContent='00'; return; }
        const diff = Date.now()-parseInt(startTime,10); const hours = Math.floor(diff/(1000*60*60)); const minutes = Math.floor((diff%(1000*60*60))/(1000*60));
        document.getElementById('runtimeHours').textContent = String(hours); document.getElementById('runtimeMinutes').textContent = String(minutes).padStart(2,'0');
    }
});
</script>

<style>
.station-card, .position-card { 
    transition: all .3s ease; 
    border-width: 2px; 
}
.station-card:hover, .position-card:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 4px 8px rgba(0,0,0,.1); 
}

.card-header:hover ~ .card-body .station-card,
.card-header:hover ~ .card-body .position-card {
    transform: none !important;
    box-shadow: none !important;
}

.card-header[data-bs-toggle="collapse"] { transition: none; }
.card-header[data-bs-toggle="collapse"]:hover { cursor: pointer; }

.card-header.bg-primary:hover { background-color: var(--bs-primary) !important; }
.card-header.bg-warning:hover { background-color: var(--bs-warning) !important; }
.card-header.bg-info:hover { background-color: var(--bs-info) !important; }

.position-card.border-light { border-color: #dee2e6 !important; }
.collapse-icon { transition: transform 0.3s ease; }

#hplcStatusCard { border-left: 4px solid #0dcaf0; box-shadow: 0 2px 10px rgba(13, 202, 240, 0.1); }
#hplcStatusCard .card-header { transition: background 0.3s ease; }
</style>
{% endblock %}

 


